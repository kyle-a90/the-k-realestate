<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="report-config.js"></script>
    
        <style>
        /* ==================================================================================
           ğŸ¨ í…Œë§ˆ ì‹œìŠ¤í…œ (CSS ë³€ìˆ˜ ê¸°ë°˜)
           ================================================================================== */
        :root {
            /* ë‹¤í¬ë¸”ë£¨ í…Œë§ˆ (ê¸°ë³¸ê°’) */
            --theme-bg-primary: #0f172a;
            --theme-bg-secondary: rgba(30, 41, 59, 0.4);
            --theme-bg-glass: rgba(30, 41, 59, 0.4);
            --theme-text-primary: #e2e8f0;
            --theme-text-secondary: #94a3b8;
            --theme-text-muted: #64748b;
            --theme-accent: #60a5fa;
            --theme-accent-hover: #3b82f6;
            --theme-border: rgba(59, 130, 246, 0.2);
            --theme-border-strong: rgba(59, 130, 246, 0.5);
            --theme-nav-bg: rgba(15, 23, 42, 0.8);
            --theme-nav-border: rgba(59, 130, 246, 0.3);
            --theme-menu-bg: rgba(15, 23, 42, 0.95);
            --theme-menu-text: #e2e8f0;
            --theme-indicator: rgba(148, 163, 184, 0.5);
            --theme-indicator-active: #60a5fa;
            --theme-counter: #94a3b8;
            --theme-login-bg: #0f172a;
            --theme-login-panel: rgba(30, 41, 59, 0.4);
            --theme-input-bg: rgba(30, 41, 59, 0.6);
            --theme-input-border: rgba(59, 130, 246, 0.3);
            --theme-input-text: #e2e8f0;
            --theme-button-bg: #3b82f6;
            --theme-button-hover: #2563eb;
            --theme-slate-50: #1e293b;
            --theme-slate-100: #334155;
            --theme-slate-200: #475569;
            --theme-slate-300: #64748b;
            --theme-slate-400: #94a3b8;
            --theme-slate-600: #cbd5e1;
            --theme-slate-700: #e2e8f0;
            --theme-slate-800: #f1f5f9;
        }

        /* í™”ì´íŠ¸ í…Œë§ˆ */
        html[data-theme="white"] {
            --theme-bg-primary: #FFFFFF;
            --theme-bg-secondary: rgba(255, 255, 255, 0.9);
            --theme-bg-glass: rgba(255, 255, 255, 0.9);
            --theme-text-primary: #0f172a;
            --theme-text-secondary: #475569;
            --theme-text-muted: #64748b;
            --theme-accent: #1E3A8A;
            --theme-accent-hover: #1e40af;
            --theme-border: #E2E8F0;
            --theme-border-strong: rgba(30, 58, 138, 0.3);
            --theme-nav-bg: rgba(255, 255, 255, 0.8);
            --theme-nav-border: rgba(30, 58, 138, 0.3);
            --theme-menu-bg: rgba(255, 255, 255, 0.95);
            --theme-menu-text: #0F172A;
            --theme-indicator: rgba(71, 85, 105, 0.5);
            --theme-indicator-active: #1E3A8A;
            --theme-counter: #475569;
            --theme-login-bg: #FFFFFF;
            --theme-login-panel: rgba(255, 255, 255, 0.9);
            --theme-input-bg: #f8fafc;
            --theme-input-border: #cbd5e1;
            --theme-input-text: #0f172a;
            --theme-button-bg: #1E3A8A;
            --theme-button-hover: #1e40af;
            --theme-slate-50: #f8fafc;
            --theme-slate-100: #f1f5f9;
            --theme-slate-200: #e2e8f0;
            --theme-slate-300: #cbd5e1;
            --theme-slate-400: #94a3b8;
            --theme-slate-600: #475569;
            --theme-slate-700: #334155;
            --theme-slate-800: #1e293b;
        }

        body { 
            background-color: var(--theme-bg-primary); 
            margin: 0; 
            padding: 0; 
            overflow: hidden; 
            height: 100vh; 
        }
        .slides-container { width: 100vw; height: 100vh; position: relative; overflow: hidden; }
        .slides-wrapper { display: flex; width: fit-content; height: 100%; transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1); align-items: center; gap: 20px; }
        .slide-page { 
            width: 1123px; 
            min-width: 1123px; 
            height: 794px; 
            background-color: var(--theme-bg-primary); 
            color: var(--theme-text-primary); 
            position: relative; 
            overflow: hidden; 
            box-shadow: 0 20px 50px -12px rgba(0, 0, 0, 0.7); 
            flex-shrink: 0; 
            transition: transform 0.6s, opacity 0.6s, filter 0.6s, z-index 0.6s; 
            transform-origin: center center; 
            z-index: 10; 
        }
        .slide-page.preview { transform: scale(0.65); opacity: 0.25; filter: brightness(0.3); z-index: 1; }
        .slide-page.preview-left { transform: translateX(-40px) scale(0.65); }
        .slide-page.preview-right { transform: translateX(40px) scale(0.65); }
        
        .slide-nav { 
            position: fixed; 
            bottom: 30px; 
            left: 50%; 
            transform: translateX(-50%) translateY(100px); 
            z-index: 1000; 
            display: flex; 
            gap: 12px; 
            align-items: center; 
            background: var(--theme-nav-bg); 
            backdrop-filter: blur(12px); 
            padding: 12px 24px; 
            border-radius: 50px; 
            border: 1px solid var(--theme-nav-border); 
            opacity: 0; 
            transition: all 0.4s ease; 
            pointer-events: none; 
        }
        .slide-nav.show { opacity: 1; transform: translateX(-50%) translateY(0); pointer-events: auto; }
        .nav-btn { 
            background: rgba(59, 130, 246, 0.2); 
            border: 1px solid var(--theme-border-strong); 
            color: var(--theme-accent); 
            width: 40px; 
            height: 40px; 
            border-radius: 50%; 
            cursor: pointer; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            transition: all 0.3s; 
            font-family: 'Montserrat', sans-serif; 
            font-weight: bold; 
        }
        html[data-theme="white"] .nav-btn {
            background: rgba(30, 58, 138, 0.2);
            border: 1px solid rgba(30, 58, 138, 0.5);
        }
        .nav-btn:hover:not(:disabled) { 
            background: rgba(59, 130, 246, 0.4); 
            transform: scale(1.1); 
        }
        html[data-theme="white"] .nav-btn:hover:not(:disabled) {
            background: rgba(30, 58, 138, 0.4);
        }
        .nav-btn:disabled { opacity: 0.3; cursor: not-allowed; }
        .slide-indicator { display: flex; gap: 8px; align-items: center; padding: 0 16px; }
        .indicator-dot { 
            width: 8px; 
            height: 8px; 
            border-radius: 50%; 
            background: var(--theme-indicator); 
            transition: all 0.3s; 
            cursor: pointer; 
        }
        .indicator-dot.active { 
            width: 24px; 
            background: var(--theme-indicator-active); 
            border-radius: 4px; 
        }
        .slide-counter { 
            color: var(--theme-counter); 
            font-family: 'Montserrat', sans-serif; 
            font-size: 12px; 
            padding: 0 12px; 
            border-left: 1px solid var(--theme-nav-border); 
            border-right: 1px solid var(--theme-nav-border); 
        }
        
        /* PDF ë©”ë‰´ ìŠ¤íƒ€ì¼ */
        .pdf-menu-container { position: relative; }
        .pdf-menu { 
            position: absolute; 
            bottom: 50px; 
            left: 50%; 
            transform: translateX(-50%); 
            background: var(--theme-menu-bg); 
            backdrop-filter: blur(12px); 
            border: 1px solid var(--theme-border-strong); 
            border-radius: 12px; 
            padding: 8px; 
            min-width: 180px; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5); 
            opacity: 0; 
            visibility: hidden; 
            transition: all 0.3s ease; 
            z-index: 1001; 
        }
        .pdf-menu.show { opacity: 1; visibility: visible; }
        .pdf-menu-item { 
            padding: 10px 16px; 
            color: var(--theme-menu-text); 
            font-family: 'Noto Sans KR', sans-serif; 
            font-size: 14px; 
            cursor: pointer; 
            border-radius: 8px; 
            transition: all 0.2s; 
            display: flex; 
            align-items: center; 
            gap: 8px; 
        }
        .pdf-menu-item:hover { 
            background: rgba(59, 130, 246, 0.2); 
            color: var(--theme-accent); 
        }
        html[data-theme="white"] .pdf-menu-item:hover {
            background: rgba(30, 58, 138, 0.2);
        }
        .pdf-menu-item:not(:last-child) { 
            border-bottom: 1px solid var(--theme-border); 
            margin-bottom: 4px; 
            padding-bottom: 10px; 
        }

        /* í…Œë§ˆ ë©”ë‰´ ìŠ¤íƒ€ì¼ */
        .theme-menu-container {
            position: relative;
        }
        .theme-menu { 
            position: absolute; 
            bottom: calc(100% + 10px); 
            left: 50%; 
            transform: translateX(-50%); 
            background: var(--theme-menu-bg); 
            backdrop-filter: blur(12px); 
            border: 1px solid var(--theme-border-strong); 
            border-radius: 12px; 
            padding: 8px; 
            min-width: 150px; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5); 
            opacity: 0; 
            visibility: hidden; 
            transition: all 0.3s ease; 
            z-index: 1001; 
        }
        .theme-menu.show { opacity: 1; visibility: visible; }
        .theme-menu-item { 
            padding: 10px 16px; 
            color: var(--theme-menu-text); 
            font-family: 'Noto Sans KR', sans-serif; 
            font-size: 14px; 
            cursor: pointer; 
            border-radius: 8px; 
            transition: all 0.2s; 
            display: flex; 
            align-items: center; 
            gap: 8px; 
        }
        .theme-menu-item:hover { 
            background: rgba(59, 130, 246, 0.2); 
            color: var(--theme-accent); 
        }
        html[data-theme="white"] .theme-menu-item:hover {
            background: rgba(30, 58, 138, 0.2);
        }
        .theme-menu-item:not(:last-child) { 
            border-bottom: 1px solid var(--theme-border); 
            margin-bottom: 4px; 
            padding-bottom: 10px; 
        }
        .theme-menu-item.active {
            background: rgba(59, 130, 246, 0.15);
            color: var(--theme-accent);
            font-weight: bold;
        }
        html[data-theme="white"] .theme-menu-item.active {
            background: rgba(30, 58, 138, 0.15);
        }

        .font-eng { font-family: 'Montserrat', sans-serif; }
        .font-kor { font-family: 'Noto Sans KR', sans-serif; }
        .text-accent { color: var(--theme-accent); } 
        .text-cyan { color: #22d3ee; }
        .text-gradient { 
            background: linear-gradient(to right, var(--theme-accent), #22d3ee); 
            -webkit-background-clip: text; 
            background-clip: text; 
            -webkit-text-fill-color: transparent; 
        }
        html[data-theme="white"] .text-gradient {
            background: linear-gradient(to right, var(--theme-accent), #dc2626);
        }
        .glass-panel { 
            background: var(--theme-bg-glass); 
            backdrop-filter: blur(12px); 
            border: 1px solid var(--theme-border); 
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); 
        }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-up { animation: fadeUp 0.8s ease-out forwards; }
        .delay-100 { animation-delay: 0.1s; } .delay-200 { animation-delay: 0.2s; }

        /* ì´ë¯¸ì§€ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        #imageModal { transition: opacity 0.3s ease; }
        #imageModal:not(.hidden) { display: flex !important; }
        #imageModal.hidden { display: none !important; }
        #modalImage { animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }

        /* ì „ì²´í™”ë©´ ì•ˆë‚´ ë©”ì‹œì§€ ìˆ¨ê¹€ */
        ::backdrop {
            display: none !important;
        }
        /* ë¸Œë¼ìš°ì € ì „ì²´í™”ë©´ ì•ˆë‚´ ë©”ì‹œì§€ ìˆ¨ê¹€ ì‹œë„ */
        *::before,
        *::after {
            content: none !important;
        }
        /* ì „ì²´í™”ë©´ ëª¨ë“œì—ì„œ ë¸Œë¼ìš°ì € ê¸°ë³¸ UI ìˆ¨ê¹€ */
        :fullscreen::backdrop,
        :-webkit-full-screen::backdrop,
        :-moz-full-screen::backdrop,
        :-ms-fullscreen::backdrop {
            display: none !important;
        }

        /* ëª¨ë°”ì¼ ë°˜ì‘í˜• ìŠ¤íƒ€ì¼ (768px ì´í•˜ì—ì„œë§Œ ì ìš©) */
        @media screen and (max-width: 768px) {
            body {
                overflow-y: auto;
                overflow-x: hidden;
            }
            .slides-container {
                width: 100vw;
                height: auto;
                min-height: 100vh;
                overflow-y: auto;
                overflow-x: hidden;
            }
            .slides-wrapper {
                flex-direction: column;
                width: 100%;
                gap: 0;
                padding: 20px 0;
            }
            .slide-page {
                width: 100vw;
                min-width: 100vw;
                height: auto;
                min-height: auto;
                box-shadow: none;
                margin: 0;
                padding: 20px 16px !important;
            }
            .slide-page.preview,
            .slide-page.preview-left,
            .slide-page.preview-right {
                transform: none;
                opacity: 1;
                filter: none;
            }
            
            /* ëª¨ë°”ì¼ ë„¤ë¹„ê²Œì´ì…˜ - ìˆ¨ê¹€ ì²˜ë¦¬ */
            .slide-nav {
                display: none !important;
            }

            /* ëª¨ë°”ì¼ í…ìŠ¤íŠ¸ í¬ê¸° ì¡°ì • */
            .font-eng.text-\[5rem\] {
                font-size: 2.5rem !important;
                line-height: 1.2 !important;
            }
            .font-kor.text-3xl {
                font-size: 1.5rem !important;
            }
            .font-kor.text-4xl {
                font-size: 1.75rem !important;
            }
            .font-kor.text-2xl {
                font-size: 1.25rem !important;
            }
            .font-kor.text-xl {
                font-size: 1.125rem !important;
            }
            .font-kor.text-lg {
                font-size: 1rem !important;
            }
            .font-eng.text-6xl {
                font-size: 2.5rem !important;
            }
            .font-eng.text-3xl {
                font-size: 1.5rem !important;
            }
            .font-eng.text-2xl {
                font-size: 1.25rem !important;
            }

            /* ëª¨ë°”ì¼ ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ ì¡°ì • */
            .grid-cols-2 {
                grid-template-columns: 1fr !important;
            }
            .grid-cols-3 {
                grid-template-columns: 1fr !important;
            }
            .grid-rows-2 {
                grid-template-rows: repeat(4, auto) !important;
            }
            
            /* col-span ì œê±° (ëª¨ë°”ì¼ì—ì„œëŠ” ì˜ë¯¸ ì—†ìŒ) */
            .col-span-1,
            .col-span-2 {
                grid-column: span 1 !important;
            }

            /* ëª¨ë°”ì¼ ê°„ê²© ì¡°ì • */
            .gap-10 {
                gap: 1.5rem !important;
            }
            .gap-8 {
                gap: 1rem !important;
            }
            .gap-6 {
                gap: 0.75rem !important;
            }
            .gap-12 {
                gap: 1rem !important;
            }

            /* ëª¨ë°”ì¼ íŒ¨ë”© ì¡°ì • */
            .p-12 {
                padding: 1rem !important;
            }
            .p-8 {
                padding: 1rem !important;
            }
            .p-6 {
                padding: 0.75rem !important;
            }
            .pl-20 {
                padding-left: 1rem !important;
            }
            .pr-10 {
                padding-right: 1rem !important;
            }
            .pl-6 {
                padding-left: 0.75rem !important;
            }
            .pr-4 {
                padding-right: 0.5rem !important;
            }

            /* ëª¨ë°”ì¼ ë§ˆì§„ ì¡°ì • */
            .mb-8 {
                margin-bottom: 1rem !important;
            }
            .mb-6 {
                margin-bottom: 0.75rem !important;
            }
            .mb-4 {
                margin-bottom: 0.5rem !important;
            }
            .mb-12 {
                margin-bottom: 1.5rem !important;
            }
            .mb-16 {
                margin-bottom: 2rem !important;
            }
            .mb-10 {
                margin-bottom: 1rem !important;
            }
            .mt-8 {
                margin-top: 1rem !important;
            }
            .mt-6 {
                margin-top: 0.75rem !important;
            }
            .mt-4 {
                margin-top: 0.5rem !important;
            }
            .mt-auto {
                margin-top: 1.5rem !important;
            }

            /* ëª¨ë°”ì¼ ë†’ì´ ì¡°ì • - h-full ì œê±° */
            .h-full {
                height: auto !important;
                min-height: auto !important;
            }
            .h-\[calc\(100\%-120px\)\] {
                height: auto !important;
                min-height: auto !important;
            }
            .h-56 {
                height: 200px !important;
            }

            /* ëª¨ë°”ì¼ íŠ¹ì • í˜ì´ì§€ ì¡°ì • */
            #page_0 {
                padding: 1.5rem 1rem !important;
                min-height: 100vh;
                display: flex !important;
                flex-direction: column !important;
            }
            
            /* ìƒë‹¨ ìˆ˜ì‹ ì¸ */
            #page_0 .absolute.top-12.right-12 {
                position: relative !important;
                top: auto !important;
                right: auto !important;
                text-align: left !important;
                margin-bottom: 1rem !important;
            }
            
            /* ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ */
            #page_0 .relative.z-10 {
                padding-left: 0 !important;
                padding-right: 0 !important;
                flex: 1 !important;
                justify-content: flex-start !important;
                padding-top: 0 !important;
            }
            
            /* INVESTMENT PROPOSAL */
            #page_0 .border-l-4 {
                margin-bottom: 1.5rem !important;
                padding-left: 0.75rem !important;
            }
            #page_0 .border-l-4 p {
                font-size: 0.75rem !important;
                letter-spacing: 0.2em !important;
            }
            
            /* í° ì œëª© */
            #page_0 h1.font-eng.text-\[5rem\] {
                font-size: 2rem !important;
                line-height: 1.1 !important;
                margin-bottom: 1rem !important;
            }
            
            /* ë¶€ì œëª© ë° ì„¤ëª… */
            #page_0 .mt-8.pl-2 {
                margin-top: 2.5rem !important;
                padding-left: 0 !important;
            }
            #page_0 h2.font-kor.text-3xl {
                font-size: 1.25rem !important;
                margin-bottom: 0.5rem !important;
            }
            #page_0 p.font-kor.text-xl {
                font-size: 0.875rem !important;
                margin-bottom: 5rem !important;
                line-height: 1.6 !important;
            }
            
            /* ì‘ì„±ì ë°•ìŠ¤ */
            #page_0 .inline-flex {
                border: none !important;
                background: none !important;
                backdrop-filter: none !important;
                padding: 0 !important;
                flex-direction: row !important;
                align-items: center !important;
                gap: 0.5rem !important;
                width: auto !important;
            }
            #page_0 .inline-flex .border-r {
                border-right: none !important;
                border-bottom: none !important;
                padding-right: 0.5rem !important;
                padding-bottom: 0 !important;
                margin-bottom: 0 !important;
                width: auto !important;
            }
            #page_0 .inline-flex span:last-child {
                font-size: 1.125rem !important;
            }
            
            /* í•˜ë‹¨ ë‚ ì§œ/ì½”ë“œ */
            #page_0 .absolute.bottom-12.left-20 {
                position: relative !important;
                bottom: auto !important;
                left: auto !important;
                margin-top: 1.5rem !important;
                flex-direction: column !important;
                gap: 0.5rem !important;
            }
            #page_0 .absolute.bottom-12.left-20 > div {
                flex-direction: column !important;
                gap: 0.5rem !important;
            }
            
            #page_0 .h-full {
                height: auto !important;
                min-height: auto !important;
            }

            /* ëª¨ë°”ì¼ ì§€ë„ iframe */
            #naver-map,
            iframe {
                height: 300px !important;
                position: relative !important;
            }
            .relative.w-full.h-full iframe {
                height: 300px !important;
                min-height: 300px !important;
            }

            /* ëª¨ë°”ì¼ ì°¨íŠ¸ */
            canvas {
                max-height: 250px !important;
            }

            /* ëª¨ë°”ì¼ KPI ì¹´ë“œ */
            .glass-panel {
                padding: 1rem !important;
                min-height: auto !important;
            }
            .text-7xl {
                font-size: 3rem !important;
            }

            /* ëª¨ë°”ì¼ ì´ë¯¸ì§€ ì˜ì—­ ë†’ì´ ì¡°ì • */
            .col-span-2 .bg-cover {
                height: 250px !important;
                min-height: 250px !important;
            }
            .absolute.bottom-6.left-6 {
                bottom: 0.5rem;
                left: 0.5rem;
                font-size: 0.75rem !important;
                padding: 0.5rem !important;
            }

            /* ëª¨ë°”ì¼ ê²°ë¡  í˜ì´ì§€ */
            .slide-page.flex.flex-col.justify-center {
                padding: 2rem 1rem 4rem 1rem !important;
                min-height: 100vh;
            }
            .slide-page.flex.flex-col.justify-center .text-5xl {
                font-size: 1.75rem !important;
            }
            .slide-page.flex.flex-col.justify-center .text-xl {
                font-size: 1rem !important;
            }
            .slide-page.flex.flex-col.justify-center .px-12 {
                padding-left: 1rem !important;
                padding-right: 1rem !important;
            }
            .slide-page.flex.flex-col.justify-center .py-8 {
                padding-top: 1rem !important;
                padding-bottom: 1rem !important;
            }
            .slide-page.flex.flex-col.justify-center .text-3xl {
                font-size: 1.5rem !important;
            }
            .slide-page.flex.flex-col.justify-center .max-w-4xl {
                max-width: 100% !important;
                width: 100% !important;
            }
            .slide-page.flex.flex-col.justify-center .absolute.bottom-12 {
                bottom: 1rem;
                position: relative !important;
                margin-top: 2rem;
                text-align: center;
            }

            /* ëª¨ë°”ì¼ í—¤ë” */
            header.flex.items-end {
                flex-direction: column;
                align-items: flex-start !important;
                gap: 0.5rem;
                margin-bottom: 1rem !important;
            }
            header .border-b {
                margin-bottom: 1rem !important;
            }

            /* ëª¨ë°”ì¼ ë¦¬ìŠ¤íŠ¸ */
            .space-y-6 > * + * {
                margin-top: 1rem !important;
            }
            .space-y-3 > * + * {
                margin-top: 0.5rem !important;
            }
            
            /* ëª¨ë°”ì¼ flex-1 ì¡°ì • */
            .flex-1 {
                flex: 1 1 auto !important;
                min-height: auto !important;
            }

            /* ëª¨ë°”ì¼ ë¡œê·¸ì¸ ë ˆì´ì–´ ìµœì í™” - í‚¤íŒ¨ë“œ ëŒ€ì‘ */
            #loginLayer {
                justify-content: flex-start !important;
                padding-top: 2rem !important;
                padding-bottom: 2rem !important;
                overflow-y: auto !important;
                -webkit-overflow-scrolling: touch !important;
            }
            #loginLayer .max-w-md {
                margin-top: auto !important;
                margin-bottom: auto !important;
            }

            /* ëª¨ë°”ì¼ ê²°ë¡  í˜ì´ì§€ ëª…í•¨ ë¶€ë¶„ ìµœì í™” */
            .slide-page.flex.flex-col.justify-center .px-20 {
                padding-left: 1rem !important;
                padding-right: 1rem !important;
            }
            .slide-page.flex.flex-col.justify-center .mb-16 {
                margin-bottom: 2rem !important;
            }
            .slide-page.flex.flex-col.justify-center .max-w-4xl {
                width: 100% !important;
                max-width: 100% !important;
                padding: 0 !important;
            }
            .slide-page.flex.flex-col.justify-center .bg-slate-800 {
                padding: 1.5rem 1rem !important;
            }
            .slide-page.flex.flex-col.justify-center .bg-slate-800 > div {
                flex-direction: column !important;
                gap: 1.5rem !important;
            }
            .slide-page.flex.flex-col.justify-center .border-l-4 {
                border-left: 2px solid !important;
                padding-left: 0.75rem !important;
            }
            .slide-page.flex.flex-col.justify-center .text-2xl {
                font-size: 1.25rem !important;
            }
            .slide-page.flex.flex-col.justify-center .text-sm {
                font-size: 0.875rem !important;
            }
            .slide-page.flex.flex-col.justify-center .grid-cols-2 {
                grid-template-columns: 1fr !important;
            }
            .slide-page.flex.flex-col.justify-center .col-span-2 {
                grid-column: span 1 !important;
            }
            .slide-page.flex.flex-col.justify-center .bg-slate-800 > div > div:last-child {
                min-width: auto !important;
                width: 100% !important;
                text-align: left !important;
            }
            .slide-page.flex.flex-col.justify-center .text-4xl {
                font-size: 1.5rem !important;
            }
            .slide-page.flex.flex-col.justify-center .text-base {
                font-size: 0.875rem !important;
            }
            .slide-page.flex.flex-col.justify-center .mb-6 {
                margin-bottom: 1rem !important;
            }
            .slide-page.flex.flex-col.justify-center .mb-3 {
                margin-bottom: 0.75rem !important;
            }
            .slide-page.flex.flex-col.justify-center .mb-2 {
                margin-bottom: 0.5rem !important;
            }
            .slide-page.flex.flex-col.justify-center .gap-10 {
                gap: 1.5rem !important;
            }
            .slide-page.flex.flex-col.justify-center .gap-2 {
                gap: 0.5rem !important;
            }
            .slide-page.flex.flex-col.justify-center .gap-x-8 {
                column-gap: 0.5rem !important;
            }
            .slide-page.flex.flex-col.justify-center .gap-y-2 {
                row-gap: 0.5rem !important;
            }
        }
    </style>
</head>
<body>
    <div id="loginLayer" class="fixed inset-0 z-[99999] flex flex-col items-center justify-center p-4" style="background-color: var(--theme-login-bg);">
        <div class="max-w-md w-full glass-panel p-8 rounded-2xl text-center shadow-2xl" style="border-color: var(--theme-border);">
            <h2 class="font-eng text-xl tracking-[0.2em] font-bold mb-6" style="color: var(--theme-accent);">ì¼€ì´í”Œëœê·¸ë£¹(The-K)</h2>
            <p class="font-kor text-sm mb-8" style="color: var(--theme-text-secondary);">ë³´ì•ˆ ë¬¸ì„œì…ë‹ˆë‹¤. ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</p>
            <input type="password" id="passwordInput" inputmode="numeric" pattern="[0-9]*" class="w-full border rounded-lg px-4 py-3 mb-6 text-center tracking-widest" style="background-color: var(--theme-input-bg); border-color: var(--theme-input-border); color: var(--theme-input-text);" placeholder="PASSWORD" onkeyup="if(window.event.keyCode==13){checkPassword()}">
            <button onclick="checkPassword()" class="w-full text-white font-bold py-3 rounded-lg transition-all" style="background-color: var(--theme-button-bg);" onmouseover="this.style.backgroundColor='var(--theme-button-hover)'" onmouseout="this.style.backgroundColor='var(--theme-button-bg)'">í™•ì¸</button>
            <p id="errorMsg" class="text-red-500 text-xs mt-4 hidden font-kor">â›” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
        </div>
    </div>

    <div class="slides-container" id="mainContent" style="display: none;">
        <div class="slides-wrapper" id="slidesWrapper">
            </div>
    </div>

    <div class="slide-nav">
        <button class="nav-btn" id="prevBtn" title="ì´ì „ ìŠ¬ë¼ì´ë“œ">â€¹</button>
        <div class="pdf-menu-container">
            <button class="nav-btn" id="pdfBtn" title="PDF ë‹¤ìš´ë¡œë“œ" style="font-size: 14px;">ğŸ’¾</button>
            <div class="pdf-menu" id="pdfMenu">
                <div class="pdf-menu-item" onclick="generatePDF(false)">
                    <span>ğŸ“„</span>
                    <span>ì¼ë°˜ ì €ì¥</span>
                </div>
                <div class="pdf-menu-item" onclick="generatePDF(true)">
                    <span>ğŸ”’</span>
                    <span>ì›Œí„°ë§ˆí¬ í¬í•¨</span>
                </div>
            </div>
        </div>
        <div class="theme-menu-container">
            <button class="nav-btn" id="themeBtn" title="í…Œë§ˆ ì„ íƒ" style="font-size: 16px;">ğŸ¨</button>
            <div class="theme-menu" id="themeMenu">
                <div class="theme-menu-item" id="themeDarkBlue" onclick="switchTheme('dark-blue')">
                    <span>ğŸŒ™</span>
                    <span>ë‹¤í¬ë¸”ë£¨</span>
                </div>
                <div class="theme-menu-item" id="themeWhite" onclick="switchTheme('white')">
                    <span>â˜€ï¸</span>
                    <span>í™”ì´íŠ¸</span>
                </div>
            </div>
        </div>
        <button class="nav-btn" id="fullscreenBtn" title="ì „ì²´í™”ë©´" style="font-size: 16px;">â›¶</button>
        <div class="slide-indicator" id="slideIndicator"></div>
        <div class="slide-counter">
            <span id="currentSlide">1</span> / <span id="totalSlides">0</span>
        </div>
        <button class="nav-btn" id="nextBtn" title="ë‹¤ìŒ ìŠ¬ë¼ì´ë“œ">â€º</button>
    </div>

    <div id="pdfLoading" style="display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 9999; flex-direction: column; align-items: center; justify-content: center; color: white;">
        <div style="width: 40px; height: 40px; border: 4px solid #3b82f6; border-top-color: transparent; border-radius: 50%; animation: spin 1s linear infinite;"></div>
        <p style="margin-top: 20px;">PDF ìƒì„± ì¤‘... <span id="pdfProgress">0%</span></p>
        <style>@keyframes spin { to { transform: rotate(360deg); } }</style>
    </div>

    <!-- ì´ë¯¸ì§€ ëª¨ë‹¬ -->
    <div id="imageModal" class="fixed inset-0 z-[99998] bg-black/90 backdrop-blur-sm hidden items-center justify-center p-4" onclick="closeImageModal(event)">
        <div class="relative max-w-[95vw] max-h-[95vh] flex items-center justify-center">
            <button onclick="closeImageModal()" class="absolute top-4 right-4 z-10 bg-black/60 hover:bg-black/80 text-white rounded-full w-12 h-12 flex items-center justify-center text-2xl font-bold transition-all" title="ë‹«ê¸° (ESC)">Ã—</button>
            <img id="modalImage" src="" alt="" class="max-w-full max-h-[95vh] object-contain rounded-lg shadow-2xl" onclick="event.stopPropagation()" />
            <div id="modalCaption" class="absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-black/60 text-white px-4 py-2 rounded text-sm pointer-events-none"></div>
        </div>
    </div>

    <script>
        // ==================================================================================
        // ğŸ–¼ï¸ ì´ë¯¸ì§€ ëª¨ë‹¬ í•¨ìˆ˜
        // ==================================================================================
        function openImageModal(imgUrl, caption) {
            const modal = document.getElementById('imageModal');
            const modalImage = document.getElementById('modalImage');
            const modalCaption = document.getElementById('modalCaption');
            
            if (modal && modalImage) {
                modalImage.src = imgUrl;
                modalImage.alt = caption || '';
                if (modalCaption) {
                    modalCaption.textContent = caption || '';
                    modalCaption.style.display = caption ? 'block' : 'none';
                }
                modal.classList.remove('hidden');
                document.body.style.overflow = 'hidden'; // ë°°ê²½ ìŠ¤í¬ë¡¤ ë°©ì§€
            }
        }

        function closeImageModal(event) {
            // ì´ë¯¸ì§€ ìì²´ë¥¼ í´ë¦­í•œ ê²½ìš°ëŠ” ë‹«ì§€ ì•ŠìŒ
            if (event && event.target && event.target.id === 'modalImage') {
                return;
            }
            
            const modal = document.getElementById('imageModal');
            if (modal) {
                modal.classList.add('hidden');
                document.body.style.overflow = ''; // ë°°ê²½ ìŠ¤í¬ë¡¤ ë³µì›
            }
        }

        // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                const modal = document.getElementById('imageModal');
                if (modal && !modal.classList.contains('hidden')) {
                    closeImageModal();
                }
            }
        });

        // ==================================================================================
        // ğŸ“‹ ë³´ê³ ì„œ ì„¤ì •ì€ report-config.js íŒŒì¼ì—ì„œ ê´€ë¦¬ë©ë‹ˆë‹¤.
        // REPORT_CONFIG ê°ì²´ëŠ” ì™¸ë¶€ ìŠ¤í¬ë¦½íŠ¸ë¡œ ë¡œë“œë©ë‹ˆë‹¤.
        // ==================================================================================

        // ==================================================================================
        // ğŸ¨ í˜ì´ì§€ í…œí”Œë¦¿
        // ==================================================================================
        const TEMPLATES = {
            cover: (d) => `
                <div class="absolute top-12 right-12 z-20 text-right">
                    <h3 class="font-kor text-xl font-bold tracking-wide" style="color: var(--theme-text-primary);">${d.recipient}</h3>
                </div>
                <div class="relative z-10 h-full flex flex-col justify-center pl-20 pr-10">
                    <div class="border-l-4 pl-6 mb-8" style="border-color: var(--theme-accent);">
                        <p class="font-eng text-lg tracking-[0.4em] font-bold" style="color: var(--theme-accent);">${d.proposalLabel || 'INVESTMENT PROPOSAL'}</p>
                    </div>
                    <h1 class="font-eng text-[5rem] font-black leading-tight" style="color: var(--theme-text-primary);">${d.title}</h1>
                    <div class="mt-8 pl-2">
                        <h2 class="font-kor text-3xl font-bold mb-2" style="color: var(--theme-text-primary);">${d.subtitle}</h2>
                        <p class="font-kor text-xl font-light mb-10" style="color: var(--theme-text-secondary);">${d.desc}</p>
                        <div class="inline-flex items-center gap-4">
                            <span class="font-eng text-sm tracking-widest" style="color: var(--theme-accent);">${d.authorLabel || 'ì‘ì„±ì'}</span>
                            <span class="font-kor text-2xl font-bold" style="color: var(--theme-text-primary);">${d.proposer}</span>
                        </div>
                    </div>
                    <div class="absolute bottom-12 left-20 flex gap-8 font-eng text-sm tracking-widest" style="color: var(--theme-text-muted);">
                        <span>${d.date}</span><span>${d.code}</span>
                    </div>
                </div>`,

            split_map: (d, h) => `
                ${getHeader(h)}
                <div class="grid grid-cols-2 gap-10 h-[calc(100%-120px)]">
                    <div class="flex flex-col gap-6">
                        <div class="glass-panel p-8 rounded-2xl flex-1">
                            <h3 class="font-kor text-xl font-bold mb-6 border-l-4 pl-4" style="color: var(--theme-text-primary); border-color: var(--theme-accent);">${h.title}</h3>
                            <ul class="space-y-6 font-kor text-base">
                                ${d.list.map(item => `<li class="flex border-b pb-3" style="border-color: var(--theme-border);"><span class="w-32" style="color: var(--theme-text-secondary);">${item.label}</span><span class="flex-1 ${item.highlight ? 'font-bold' : ''}" style="color: ${item.color ? (item.color.includes('cyan') ? '#22d3ee' : 'var(--theme-text-primary)') : 'var(--theme-text-primary)'};">${item.value}</span></li>`).join('')}
                            </ul>
                        </div>
                    </div>
                    <div class="relative w-full h-full rounded-2xl overflow-hidden group cursor-pointer" style="background-color: var(--theme-slate-50); border: 1px solid var(--theme-border);" onclick="window.open('${d.naverMapUrl || `https://map.naver.com/v5/search/${encodeURIComponent(d.address)}`}', '_blank')" title="í´ë¦­í•˜ì—¬ ë„¤ì´ë²„ ì§€ë„ì—ì„œ ë³´ê¸°">
                        <img src="${d.mapImageUrl || `https://maps.google.com/maps?q=${encodeURIComponent(d.address)}&output=embed&z=15`}" alt="ì§€ë„" class="w-full h-full object-cover" style="display: block;" />
                        <div class="absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-all duration-300 flex items-center justify-center pointer-events-none">
                            <span class="opacity-0 group-hover:opacity-100 text-white font-kor text-lg font-bold bg-black/50 px-4 py-2 rounded transition-opacity duration-300">ğŸ—ºï¸ ë„¤ì´ë²„ ì§€ë„ì—ì„œ ë³´ê¸°</span>
                        </div>
                    </div>
                </div>`,

            grid_kpi: (d, h) => `
                ${getHeader(h)}
                <div class="grid grid-cols-2 grid-rows-2 gap-6 h-[calc(100%-120px)]">
                    ${d.cards.map(c => `
                        <div class="glass-panel p-8 rounded-2xl border-l-8 relative group hover:-translate-y-1 transition overflow-hidden" style="border-color: var(--theme-accent);">
                            <div class="absolute right-4 top-4 text-7xl opacity-10 select-none pointer-events-none">${c.icon}</div>
                            <p class="font-eng text-sm tracking-wider mb-2 relative z-10" style="color: var(--theme-text-secondary);">${c.title}</p>
                            <p class="font-eng text-6xl font-black relative z-10" style="color: var(--theme-text-primary);">${c.value} <span class="text-3xl" style="color: ${c.color.includes('cyan') ? '#22d3ee' : 'var(--theme-accent)'};">${c.unit}</span></p>
                            <p class="font-kor font-bold mt-4 text-lg relative z-10" style="color: var(--theme-accent);">${c.desc}</p>
                            <p class="font-kor text-sm mt-1 relative z-10" style="color: var(--theme-text-muted);">${c.sub}</p>
                        </div>
                    `).join('')}
                </div>`,

            split_list_img: (d, h) => `
                ${getHeader(h)}
                <div class="grid grid-cols-3 gap-8 h-[calc(100%-120px)]">
                    <div class="col-span-1 flex flex-col gap-6 h-full">
                        ${d.items.map((item, idx) => {
                            const colors = [{t:'#60a5fa',b:'#3b82f6'}, {t:'#22d3ee',b:'#06b6d4'}, {t:'#34d399',b:'#10b981'}];
                            const theme = colors[idx % 3];
                            return `<div class="glass-panel p-6 rounded-xl border-l-4 flex-1 flex flex-col justify-center" style="border-color: ${theme.b};"><h3 class="font-kor text-xl font-bold mb-3" style="color: ${theme.t};">${item.title}</h3><p class="font-kor text-sm leading-relaxed" style="color: var(--theme-text-secondary);">${item.desc}</p></div>`;
                        }).join('')}
                    </div>
                    <div class="col-span-2 rounded-2xl overflow-hidden relative group cursor-pointer" style="background-color: var(--theme-slate-50); border: 1px solid var(--theme-border);" onclick="openImageModal('${d.imgUrl}', '${d.imgCaption.replace(/'/g, "\\'")}')" title="í´ë¦­í•˜ì—¬ ì›ë³¸ í¬ê¸°ë¡œ ë³´ê¸°">
                        <img src="${d.imgUrl}" alt="${d.imgCaption}" class="w-full h-full object-cover" style="display: block;" />
                        <div class="absolute bottom-6 left-6 bg-black/60 px-4 py-2 rounded pointer-events-none"><span class="text-white text-sm">${d.imgCaption}</span></div>
                        <div class="absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-all duration-300 flex items-center justify-center pointer-events-none">
                            <span class="opacity-0 group-hover:opacity-100 text-white font-kor text-lg font-bold bg-black/50 px-4 py-2 rounded transition-opacity duration-300">ğŸ” í´ë¦­í•˜ì—¬ í™•ëŒ€</span>
                        </div>
                    </div>
                </div>`,

            double_card: (d, h) => `
                ${getHeader(h)}
                <div class="grid grid-cols-2 gap-10 h-[calc(100%-120px)]">
                    ${[d.left, d.right].map((item, idx) => {
                        const accentColor = idx === 0 ? 'var(--theme-accent)' : '#22d3ee';
                        return `
                        <div class="glass-panel p-8 rounded-2xl flex flex-col">
                            <h3 class="font-kor text-2xl font-bold mb-6 flex items-center gap-3" style="color: ${accentColor};"><span class="text-3xl">${item.icon}</span> ${item.title}</h3>
                            <div class="space-y-6 mb-6">
                                <div class="p-5 rounded-xl" style="background-color: ${idx===0 ? 'rgba(59, 130, 246, 0.2)' : 'rgba(34, 211, 238, 0.2)'}; border: 1px solid ${accentColor}40;">
                                    <span class="block text-sm mb-1" style="color: var(--theme-text-secondary);">${item.highlightBox.label}</span>
                                    <span class="block text-3xl font-bold" style="color: var(--theme-text-primary);">${item.highlightBox.value}</span>
                                </div>
                                <ul class="font-kor space-y-3" style="color: var(--theme-text-secondary);">
                                    ${item.list.map(l => `<li class="flex items-start gap-2"><span style="color: ${accentColor};">âœ”</span><span>${l}</span></li>`).join('')}
                                </ul>
                                ${item.tag ? `<div class="mt-4 text-center"><span class="inline-block text-white text-sm font-bold px-4 py-2 rounded-full" style="background-color: #10b981;">${item.tag}</span></div>` : ''}
                            </div>
                            <div class="mt-auto p-5 rounded-xl" style="background-color: var(--theme-slate-50); border: 1px solid var(--theme-border);">
                                <h4 class="font-eng text-xs font-bold mb-2 tracking-wider" style="color: var(--theme-text-secondary);">${item.note.title}</h4>
                                <p class="font-kor text-sm leading-relaxed" style="color: var(--theme-text-secondary);">${item.note.desc}</p>
                            </div>
                        </div>
                    `;
                    }).join('')}
                </div>`,

            chart_risk: (d, h, pageId) => `
                ${getHeader(h)}
                <div class="grid grid-cols-2 gap-12 h-[calc(100%-120px)]">
                    <div class="flex flex-col gap-8 h-full">
                        <div class="prose mt-4" style="color: var(--theme-text-primary);">${d.mainText}</div>
                        <div class="glass-panel p-6 rounded-xl border-l-4 mt-auto" style="border-color: var(--theme-accent);">
                            <h4 class="font-kor text-xl font-bold mb-2" style="color: var(--theme-accent);">ğŸ’¡ Strategic Value</h4>
                            <p class="font-kor text-sm" style="color: var(--theme-text-secondary);">${d.subText}</p>
                        </div>
                    </div>
                    <div class="glass-panel p-8 rounded-2xl flex flex-col">
                        <h3 class="font-kor text-lg font-bold mb-6 text-center" style="color: var(--theme-text-primary);">ì§€ì—­ë³„ ì „ë ¥ ê³µê¸‰ ê±°ë¶€ í™•ë¥ </h3>
                        <div class="flex-1 relative"><canvas id="${pageId}_chart"></canvas></div>
                    </div>
                </div>`,

            chart_economy: (d, h, pageId) => `
                ${getHeader(h)}
                <div class="grid grid-cols-2 gap-10 h-[calc(100%-120px)]">
                    <div class="glass-panel p-8 rounded-2xl flex flex-col">
                        <h3 class="font-kor text-xl font-bold mb-4 border-b pb-2" style="color: var(--theme-text-primary); border-color: var(--theme-border);">${d.chartTitle}</h3>
                        <div class="h-56 relative mb-4"><canvas id="${pageId}_chart"></canvas></div>
                        <div class="text-center font-bold mb-6" style="color: var(--theme-accent);">${d.chartDesc}</div>
                        <div class="mt-auto p-5 rounded-xl" style="background-color: var(--theme-slate-50); border: 1px solid var(--theme-border);">
                            <h4 class="font-eng text-xs font-bold mb-2 tracking-wider" style="color: var(--theme-text-secondary);">${d.notes[0].title}</h4>
                            <p class="font-kor text-sm leading-relaxed" style="color: var(--theme-text-secondary);">${d.notes[0].desc}</p>
                        </div>
                    </div>
                    <div class="glass-panel p-8 rounded-2xl flex flex-col">
                        <h3 class="font-kor text-xl font-bold mb-4 border-b pb-2" style="color: var(--theme-text-primary); border-color: var(--theme-border);">ğŸ’° CAPEX ê²½ìŸë ¥: í† ì§€ë¹„</h3>
                        <div class="space-y-6 mt-6 mb-6">
                            ${d.capexList.map(i => {
                                const isAccent = i.style === 'accent';
                                const bgStyle = isAccent ? 'rgba(59, 130, 246, 0.2)' : 'var(--theme-slate-50)';
                                const borderStyle = isAccent ? '2px solid var(--theme-accent)' : '1px solid var(--theme-border)';
                                const labelColor = isAccent ? 'var(--theme-accent)' : 'var(--theme-text-secondary)';
                                const textSize = isAccent ? 'text-2xl' : 'font-bold';
                                return `<div class="flex items-center justify-between rounded-lg ${isAccent ? 'p-6 transform scale-105 shadow-lg' : 'p-4'}" style="background-color: ${bgStyle}; border: ${borderStyle};"><span class="${isAccent ? 'font-bold text-lg' : ''}" style="color: ${labelColor};">${i.label}</span><span class="font-bold ${textSize}" style="color: var(--theme-text-primary);">${i.price}</span></div>`;
                            }).join('')}
                        </div>
                        <div class="mt-auto p-5 rounded-xl" style="background-color: var(--theme-slate-50); border: 1px solid var(--theme-border);">
                            <h4 class="font-eng text-xs font-bold mb-2 tracking-wider" style="color: var(--theme-text-secondary);">${d.notes[1].title}</h4>
                            <p class="font-kor text-sm leading-relaxed" style="color: var(--theme-text-secondary);">${d.notes[1].desc}</p>
                        </div>
                    </div>
                </div>`,

            swot: (d, h) => {
                const map = { S: {c:'blue', t:'STRENGTH'}, W: {c:'slate', t:'WEAKNESS'}, O: {c:'red', t:'OPPORTUNITY'}, T: {c:'yellow', t:'THREAT'} };
                return `
                ${getHeader(h)}
                <div class="grid grid-cols-2 gap-6 h-[calc(100%-120px)]">
                    ${Object.entries(d).map(([key, items]) => `
                        <div class="bg-slate-800/80 p-6 rounded-xl border-t-4 border-${map[key].c}-500">
                            <h4 class="font-eng text-${map[key].c}-400 font-bold mb-3 text-3xl">${map[key].t} (${key})</h4>
                            <ul class="text-slate-300 text-l space-y-2 list-disc pl-5">${items.map(i => `<li>${i}</li>`).join('')}</ul>
                        </div>
                    `).join('')}
                </div>`;
            },

            zoning: (d, h) => `
                ${getHeader(h)}
                <div class="grid grid-cols-2 gap-10 h-[calc(100%-120px)]">
                    <div class="flex flex-col gap-6">
                        <div class="glass-panel p-8 rounded-2xl flex-1 border-l-4 border-white">
                            <h3 class="font-eng text-2xl font-bold text-white mb-6">ZONING PLAN</h3>
                            <div class="space-y-6">
                                ${d.zones.map(z => `<div class="bg-${z.color}-900/30 p-5 rounded-xl border border-${z.color}-500/30"><span class="text-${z.color==='blue'?'accent':'amber-400'} font-bold text-lg block mb-2">${z.title}</span><p class="text-slate-300 text-m">${z.desc}</p></div>`).join('')}
                            </div>
                        </div>
                    </div>
                    <div class="relative bg-slate-800 rounded-2xl overflow-hidden border border-slate-600 group cursor-pointer" onclick="openImageModal('${d.imgUrl}', '${d.imgCaption.replace(/'/g, "\\'")}')" title="í´ë¦­í•˜ì—¬ ì›ë³¸ í¬ê¸°ë¡œ ë³´ê¸°">
                        <img src="${d.imgUrl}" alt="${d.imgCaption}" class="w-full h-full object-cover" style="display: block;" />
                        <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
                            <div class="text-center p-6 bg-black/50 backdrop-blur rounded-xl border border-slate-500">
                                <span class="block text-4xl mb-2">ğŸ—ï¸</span>
                                <span class="text-white font-kor font-bold">${d.imgCaption}</span>
                            </div>
                        </div>
                        <div class="absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-all duration-300 flex items-center justify-center pointer-events-none">
                            <span class="opacity-0 group-hover:opacity-100 text-white font-kor text-lg font-bold bg-black/50 px-4 py-2 rounded transition-opacity duration-300">ğŸ” í´ë¦­í•˜ì—¬ í™•ëŒ€</span>
                        </div>
                    </div>
                </div>`,

            conclusion: (d) => `
                <div class="relative z-10 w-full h-full flex flex-col items-center justify-center px-20">
                    <div class="text-center mb-16">
                        <h2 class="font-eng text-lg tracking-[0.6em] font-bold mb-6 animate-fade-up opacity-0" style="animation-delay: 0.1s; animation-fill-mode: forwards; color: var(--theme-accent);">CONCLUSION</h2>
                        <h1 class="font-kor text-5xl font-bold leading-tight mb-8 animate-fade-up opacity-0" style="animation-delay: 0.2s; animation-fill-mode: forwards; color: var(--theme-text-primary);">${d.title}</h1>
                        <p class="font-kor text-xl font-light leading-relaxed animate-fade-up opacity-0" style="animation-delay: 0.3s; animation-fill-mode: forwards; color: var(--theme-text-secondary);">${d.desc}</p>
                    </div>
                    
                    <div class="w-full max-w-4xl animate-fade-up opacity-0" style="animation-delay: 0.4s; animation-fill-mode: forwards;">
                        <div class="rounded-2xl p-10 shadow-xl relative overflow-hidden" style="background-color: var(--theme-slate-50); border: 1px solid var(--theme-border);">
                            
                            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-10">
                                <div class="flex-1 border-l-4 pl-6" style="border-color: var(--theme-border);">
                                    <h3 class="font-kor text-2xl font-bold mb-3 tracking-tight" style="color: var(--theme-text-primary);">${d.companyName}</h3>
                                    <p class="font-kor text-sm mb-6 font-light" style="color: var(--theme-text-secondary);">${d.companyAddress}</p>
                                    
                                    <div class="grid grid-cols-2 gap-y-2 gap-x-8 font-kor text-sm" style="color: var(--theme-text-muted);">
                                        <div class="flex gap-2"><span>ë“±ë¡ë²ˆí˜¸</span> <span style="color: var(--theme-text-secondary);">${d.registrationNum}</span></div>
                                        <div class="flex gap-2"><span>ëŒ€í‘œì</span> <span style="color: var(--theme-text-secondary);">${d.ceoName}</span></div>
                                        <div class="flex gap-2 col-span-2"><span>ëŒ€í‘œì „í™”</span> <span style="color: var(--theme-text-secondary);">${d.companyPhone}</span></div>
                                    </div>
                                </div>

                                <div class="text-right min-w-[240px]">
                                    <p class="font-kor text-sm font-bold tracking-wider mb-2 uppercase" style="color: var(--theme-accent);">${d.contactTitle}</p>
                                    <p class="font-eng text-4xl font-black tracking-tight mb-2" style="color: var(--theme-text-primary);">${d.mobile}</p>
                                    <p class="font-eng text-base inline-block pb-1" style="color: var(--theme-text-secondary); border-bottom: 1px solid var(--theme-border);">${d.email}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`,
        };

        function getHeader(h) {
            if(!h) return '';
            return `
            <header class="flex items-end justify-between border-b pb-6 mb-8" style="border-color: var(--theme-border);">
                <div><h2 class="font-kor text-4xl font-bold tracking-tight" style="color: var(--theme-text-primary);">${h.section}</h2></div>
                <p class="font-kor text-lg" style="color: var(--theme-text-secondary);">${h.title}</p>
            </header>`;
        }

        // ==================================================================================
        // ğŸš€ ì´ˆê¸°í™” ë° ë Œë”ë§
        // ==================================================================================
        let currentSlideIndex = 0;
        let slides = [];

        document.addEventListener("DOMContentLoaded", () => {
            // í…Œë§ˆ ì ìš©
            const theme = REPORT_CONFIG.settings.theme || "dark-blue";
            document.documentElement.setAttribute('data-theme', theme);
            
            // í…Œë§ˆ ë©”ë‰´ì—ì„œ í™œì„± ìƒíƒœ ì„¤ì •
            setTimeout(() => {
                const darkBlueItem = document.getElementById('themeDarkBlue');
                const whiteItem = document.getElementById('themeWhite');
                if (darkBlueItem && whiteItem) {
                    if (theme === 'dark-blue') {
                        darkBlueItem.classList.add('active');
                        whiteItem.classList.remove('active');
                    } else {
                        whiteItem.classList.add('active');
                        darkBlueItem.classList.remove('active');
                    }
                }
            }, 100);
            
            // í˜ì´ì§€ ì œëª© ì„¤ì •
            if (REPORT_CONFIG.settings.pageTitle) {
                document.title = REPORT_CONFIG.settings.pageTitle;
            }
            
            // ì „ì²´í™”ë©´ ì•„ì´ì½˜ ì´ˆê¸°í™”
            setTimeout(() => {
                if (typeof updateFullscreenIcon === 'function') {
                    updateFullscreenIcon();
                }
            }, 100);
            
            // ëª¨ë°”ì¼ì—ì„œ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ì°½ í¬ì»¤ìŠ¤ ì‹œ ìë™ ìŠ¤í¬ë¡¤ ì²˜ë¦¬
            const passwordInput = document.getElementById('passwordInput');
            if (passwordInput) {
                passwordInput.addEventListener('focus', function() {
                    // ëª¨ë°”ì¼ í™˜ê²½ í™•ì¸
                    if (window.innerWidth <= 768) {
                        // ì…ë ¥ì°½ì´ ë³´ì´ë„ë¡ ìŠ¤í¬ë¡¤
                        setTimeout(() => {
                            this.scrollIntoView({ 
                                behavior: 'smooth', 
                                block: 'center',
                                inline: 'nearest'
                            });
                        }, 300); // í‚¤íŒ¨ë“œê°€ ì˜¬ë¼ì˜¬ ì‹œê°„ì„ ê³ ë ¤í•œ ì§€ì—°
                    }
                });
            }
            
            initSecurity();
            renderApp();
            
            // ë„¤ë¹„ê²Œì´ì…˜ ë°” ìë™ ìˆ¨ê¹€ ê¸°ëŠ¥ (PCì—ì„œë§Œ)
            const isMobileOnLoad = window.innerWidth <= 768;
            if (!isMobileOnLoad) {
                let hideNavTimer = null;
                const navBar = document.querySelector('.slide-nav');
                const HIDE_DELAY = 2500; // 2.5ì´ˆ í›„ ìë™ ìˆ¨ê¹€

                function showNavBar() {
                    if (navBar) {
                        navBar.classList.add('show');
                        // íƒ€ì´ë¨¸ ë¦¬ì…‹
                        clearTimeout(hideNavTimer);
                        hideNavTimer = setTimeout(() => {
                            navBar.classList.remove('show');
                        }, HIDE_DELAY);
                    }
                }

                // ë§ˆìš°ìŠ¤ ì›€ì§ì„ ê°ì§€
                document.addEventListener('mousemove', () => {
                    showNavBar();
                });

                // ë„¤ë¹„ê²Œì´ì…˜ ë°”ì— ë§ˆìš°ìŠ¤ í˜¸ë²„ ì‹œ ìˆ¨ê¹€ ë°©ì§€
                if (navBar) {
                    navBar.addEventListener('mouseenter', () => {
                        clearTimeout(hideNavTimer);
                        navBar.classList.add('show');
                    });
                    navBar.addEventListener('mouseleave', () => {
                        hideNavTimer = setTimeout(() => {
                            navBar.classList.remove('show');
                        }, HIDE_DELAY);
                    });
                }

                // ì´ˆê¸° ë¡œë“œ ì‹œ 2ì´ˆ í›„ ìë™ ìˆ¨ê¹€
                setTimeout(() => {
                    if (navBar) {
                        navBar.classList.add('show');
                        hideNavTimer = setTimeout(() => {
                            navBar.classList.remove('show');
                        }, HIDE_DELAY);
                    }
                }, 1000);
            }
        });

        function renderApp() {
            const wrapper = document.getElementById('slidesWrapper');
            wrapper.innerHTML = ''; // ê¸°ì¡´ ë‚´ìš© ì´ˆê¸°í™”

            // 1. Configì— ë”°ë¼ HTML ìƒì„±
            // 1137-1139ë²ˆì§¸ ì¤„ ìˆ˜ì •
            REPORT_CONFIG.pages.forEach((page, index) => {
                const section = document.createElement('section');
                const theme = REPORT_CONFIG.settings.theme || 'dark-blue';
                const bgClass = page.type === 'cover' ? '' : (theme === 'white' ? 'p-12 bg-white' : 'p-12 bg-slate-900');
                section.className = `slide-page ${bgClass} ${page.type === 'conclusion' ? 'flex flex-col justify-center items-center' : ''}`;
                section.id = `page_${index}`;
                
                
                // í…œí”Œë¦¿ ì‹¤í–‰
                if (TEMPLATES[page.type]) {
                    // ì°¨íŠ¸ìš© ID ìƒì„±ì„ ìœ„í•´ index ì „ë‹¬
                    section.innerHTML = TEMPLATES[page.type](page.data, page.header, `page_${index}`);
                }
                wrapper.appendChild(section);
            });

            // 2. ì°¨íŠ¸ ë Œë”ë§ (HTML ìƒì„± í›„ ì‹¤í–‰)
            initCharts();

            // 3. ìŠ¬ë¼ì´ë“œ ê¸°ëŠ¥ ì´ˆê¸°í™” (PCì—ì„œë§Œ)
            const isMobile = window.innerWidth <= 768;
            if (!isMobile) {
                initSlides();
            }
        }

        function initCharts() {
            Chart.defaults.color = '#94a3b8';
            Chart.defaults.font.family = "'Noto Sans KR', sans-serif";
            
            REPORT_CONFIG.pages.forEach((page, index) => {
                const canvasId = `page_${index}_chart`;
                const canvas = document.getElementById(canvasId);
                
                if (canvas && page.type === 'chart_risk') {
                    new Chart(canvas, {
                        type: 'bar',
                        data: {
                            labels: page.data.chartLabels,
                            datasets: [{
                                label: 'í™•ë¥  (%)',
                                data: page.data.chartData,
                                backgroundColor: ['#ef4444', '#3b82f6'],
                                borderRadius: 4,
                                minBarLength: 20
                            }]
                        },
                        options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, max: 100, grid: { color: '#334155' } }, x: { grid: { display: false } } }, plugins: { legend: { display: false } } }
                    });
                } else if (canvas && page.type === 'chart_economy') {
                     new Chart(canvas, {
                        type: 'bar',
                        indexAxis: 'y',
                        data: {
                            labels: page.data.chartLabels,
                            datasets: [{
                                label: 'ë¹„ìš© (10ì–µ)',
                                data: page.data.chartData,
                                backgroundColor: ['#475569', '#3b82f6'],
                                borderRadius: 4
                            }]
                        },
                        options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { beginAtZero: true, grid: { color: '#334155' } } } }
                    });
                }
            });
        }

        // ==================================================================================
        // ğŸï¸ ìŠ¬ë¼ì´ë“œ ë„¤ë¹„ê²Œì´ì…˜
        // ==================================================================================
        function initSlides() {
            slides = document.querySelectorAll('.slide-page');
            const totalSlidesEl = document.getElementById('totalSlides');
            if (totalSlidesEl) {
                totalSlidesEl.textContent = slides.length;
            }
            updateSlidePosition();
            createIndicators();
            updateNavigation();
            
            // ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ (PCì—ì„œë§Œ)
            const isMobile = window.innerWidth <= 768;
            if (!isMobile) {
                const prevBtn = document.getElementById('prevBtn');
                const nextBtn = document.getElementById('nextBtn');
                if (prevBtn && nextBtn) {
                    prevBtn.addEventListener('click', prevSlide);
                    nextBtn.addEventListener('click', nextSlide);
                }
            }
        }

        function updateSlidePosition() {
            const wrapper = document.getElementById('slidesWrapper');
            const isMobile = window.innerWidth <= 768;
            
            if (isMobile) {
                // ëª¨ë°”ì¼: ìŠ¬ë¼ì´ë“œ ë„¤ë¹„ê²Œì´ì…˜ ê¸°ëŠ¥ ì™„ì „ ë¹„í™œì„±í™”
                // ì•„ë¬´ ì‘ì—…ë„ í•˜ì§€ ì•ŠìŒ (ì¼ë°˜ ì„¸ë¡œ ìŠ¤í¬ë¡¤ë§Œ ì‚¬ìš©)
                return;
            }
            
            // PC: ê¸°ì¡´ ê°€ë¡œ ìŠ¬ë¼ì´ë“œ ë°©ì‹ (ëª¨ë°”ì¼ì´ ì•„ë‹ ë•Œë§Œ ì‹¤í–‰)
            const slideWidth = 1123; 
            const gap = 20; 
            const centerPosition = (window.innerWidth - slideWidth) / 2;
            const currentSlidePosition = currentSlideIndex * (slideWidth + gap);
            wrapper.style.transform = `translateX(${centerPosition - currentSlidePosition}px)`;
            
            slides.forEach((slide, index) => {
                slide.classList.remove('preview', 'preview-left', 'preview-right');
                if (index === currentSlideIndex + 1) slide.classList.add('preview', 'preview-right');
                else if (index === currentSlideIndex - 1) slide.classList.add('preview', 'preview-left');
                else if (index !== currentSlideIndex) slide.classList.add('preview');
            });
            
            // PCì—ì„œë§Œ ì¸ë””ì¼€ì´í„°ì™€ ì¹´ìš´í„° ì—…ë°ì´íŠ¸
            updateIndicators();
            const currentSlideEl = document.getElementById('currentSlide');
            if (currentSlideEl) {
                currentSlideEl.textContent = currentSlideIndex + 1;
            }
            updateNavigation();
        }

        function createIndicators() {
            const isMobile = window.innerWidth <= 768;
            if (isMobile) {
                return; // ëª¨ë°”ì¼ì—ì„œëŠ” ì¸ë””ì¼€ì´í„° ìƒì„± ë¶ˆí•„ìš”
            }
            
            const indicator = document.getElementById('slideIndicator');
            if (!indicator) {
                return; // ì¸ë””ì¼€ì´í„° ìš”ì†Œê°€ ì—†ìœ¼ë©´ ì¢…ë£Œ
            }
            
            indicator.innerHTML = '';
            slides.forEach((_, i) => {
                const dot = document.createElement('div');
                dot.className = `indicator-dot ${i === currentSlideIndex ? 'active' : ''}`;
                dot.addEventListener('click', () => goToSlide(i));
                indicator.appendChild(dot);
            });
        }

        function updateIndicators() {
            const isMobile = window.innerWidth <= 768;
            if (isMobile) {
                return; // ëª¨ë°”ì¼ì—ì„œëŠ” ì¸ë””ì¼€ì´í„° ì—…ë°ì´íŠ¸ ë¶ˆí•„ìš”
            }
            
            const dots = document.querySelectorAll('.indicator-dot');
            dots.forEach((dot, index) => {
                if (index === currentSlideIndex) {
                    dot.classList.add('active');
                } else {
                    dot.classList.remove('active');
                }
            });
        }

        function updateNavigation() {
            const isMobile = window.innerWidth <= 768;
            if (isMobile) {
                return; // ëª¨ë°”ì¼ì—ì„œëŠ” ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ì—…ë°ì´íŠ¸ ë¶ˆí•„ìš”
            }
            
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            if (prevBtn && nextBtn) {
                prevBtn.disabled = currentSlideIndex === 0;
                nextBtn.disabled = currentSlideIndex === slides.length - 1;
            }
        }

        function goToSlide(index) {
            const isMobile = window.innerWidth <= 768;
            if (isMobile) {
                return; // ëª¨ë°”ì¼ì—ì„œëŠ” ì‘ë™í•˜ì§€ ì•ŠìŒ
            }
            
            if (index >= 0 && index < slides.length) {
                currentSlideIndex = index;
                updateSlidePosition();
                updateNavigation();
            }
        }

        function nextSlide() {
            const isMobile = window.innerWidth <= 768;
            if (isMobile) {
                return; // ëª¨ë°”ì¼ì—ì„œëŠ” ì‘ë™í•˜ì§€ ì•ŠìŒ
            }
            
            if (currentSlideIndex < slides.length - 1) {
                goToSlide(currentSlideIndex + 1);
            }
        }

        function prevSlide() {
            const isMobile = window.innerWidth <= 768;
            if (isMobile) {
                return; // ëª¨ë°”ì¼ì—ì„œëŠ” ì‘ë™í•˜ì§€ ì•ŠìŒ
            }
            
            if (currentSlideIndex > 0) {
                goToSlide(currentSlideIndex - 1);
            }
        }

        // ìœˆë„ìš° ë¦¬ì‚¬ì´ì¦ˆ ì‹œ ìŠ¬ë¼ì´ë“œ ìœ„ì¹˜ ì¬ì¡°ì • (PCì—ì„œë§Œ)
        window.addEventListener('resize', () => {
            const isMobile = window.innerWidth <= 768;
            if (!isMobile) {
                updateSlidePosition();
            }
        });

        // í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ (PCì—ì„œë§Œ ì‘ë™)
        document.addEventListener('keydown', (e) => {
            const isMobile = window.innerWidth <= 768;
            if (isMobile) {
                return; // ëª¨ë°”ì¼ì—ì„œëŠ” í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ë¬´ì‹œ
            }
            
            if (e.key === 'ArrowRight' || e.key === 'ArrowDown' || e.key === 'PageDown') {
                nextSlide();
            } else if (e.key === 'ArrowLeft' || e.key === 'ArrowUp' || e.key === 'PageUp') {
                prevSlide();
            } else if (e.key === 'Home') {
                goToSlide(0);
            } else if (e.key === 'End') {
                goToSlide(slides.length - 1);
            }
        });

        // ë§ˆìš°ìŠ¤ íœ  ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ (PCì—ì„œë§Œ ì‘ë™)
        let wheelTimeout = null;
        let isWheeling = false;
        
        document.addEventListener('wheel', (e) => {
            const isMobile = window.innerWidth <= 768;
            if (isMobile) {
                return; // ëª¨ë°”ì¼ì—ì„œëŠ” ë§ˆìš°ìŠ¤ íœ  ì´ë²¤íŠ¸ ë¬´ì‹œ
            }
            
            // ìŠ¤í¬ë¡¤ì´ ë„ˆë¬´ ë¹ ë¥´ê²Œ ë°œìƒí•˜ì§€ ì•Šë„ë¡ ì¿¨ë‹¤ìš´ ì ìš©
            if (isWheeling) {
                return;
            }
            
            // ê¸°ë³¸ ìŠ¤í¬ë¡¤ ë™ì‘ ë°©ì§€
            e.preventDefault();
            
            // íœ  ë°©í–¥ì— ë”°ë¼ ìŠ¬ë¼ì´ë“œ ì´ë™
            if (e.deltaY > 0) {
                // ì•„ë˜ë¡œ ìŠ¤í¬ë¡¤ (ë‹¤ìŒ ìŠ¬ë¼ì´ë“œ)
                nextSlide();
            } else if (e.deltaY < 0) {
                // ìœ„ë¡œ ìŠ¤í¬ë¡¤ (ì´ì „ ìŠ¬ë¼ì´ë“œ)
                prevSlide();
            }
            
            // ì¿¨ë‹¤ìš´ ì„¤ì • (500ms ë™ì•ˆ ì¶”ê°€ íœ  ì´ë²¤íŠ¸ ë¬´ì‹œ)
            isWheeling = true;
            clearTimeout(wheelTimeout);
            wheelTimeout = setTimeout(() => {
                isWheeling = false;
            }, 500);
        }, { passive: false });

        // ==================================================================================
        // ğŸ”’ ë³´ì•ˆ ë° PDF
        // ==================================================================================
        function initSecurity() {
            const pw = REPORT_CONFIG.settings.password;
            if(!pw) checkPassword(true);
        }
        function checkPassword(force = false) {
            const input = document.getElementById('passwordInput');
            if (force || input.value === REPORT_CONFIG.settings.password) {
                const layer = document.getElementById('loginLayer');
                layer.style.opacity = "0";
                setTimeout(() => { 
                    layer.style.display = "none"; 
                    document.getElementById('mainContent').style.display = "block";
                    const isMobile = window.innerWidth <= 768;
                    if (!isMobile) {
                        initSlides();
                    }
                }, 500);
            } else {
                document.getElementById('errorMsg').classList.remove('hidden');
                input.value = '';
            }
        }

        // í°íŠ¸ ë¡œë”© ì™„ë£Œ ëŒ€ê¸° í•¨ìˆ˜
        async function waitForFonts() {
            if (document.fonts && document.fonts.ready) {
                await document.fonts.ready;
            }
            // ì¶”ê°€ ëŒ€ê¸° ì‹œê°„ (í°íŠ¸ ë Œë”ë§ ì™„ë£Œ ë³´ì¥)
            await new Promise(resolve => setTimeout(resolve, 500));
        }

        // PDF ë©”ë‰´ í‘œì‹œ/ìˆ¨ê¹€ ì²˜ë¦¬
        const pdfBtn = document.getElementById('pdfBtn');
        const pdfMenu = document.getElementById('pdfMenu');
        
        pdfBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            pdfMenu.classList.toggle('show');
            // ë‹¤ë¥¸ ë©”ë‰´ ë‹«ê¸°
            const themeMenu = document.getElementById('themeMenu');
            if (themeMenu) themeMenu.classList.remove('show');
        });
        
        // í…Œë§ˆ ë©”ë‰´ í‘œì‹œ/ìˆ¨ê¹€ ì²˜ë¦¬
        const themeBtn = document.getElementById('themeBtn');
        const themeMenu = document.getElementById('themeMenu');
        
        if (themeBtn && themeMenu) {
            themeBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                themeMenu.classList.toggle('show');
                // ë‹¤ë¥¸ ë©”ë‰´ ë‹«ê¸°
                pdfMenu.classList.remove('show');
            });
        }
        
        // ì „ì²´í™”ë©´ ë²„íŠ¼ ì²˜ë¦¬
        const fullscreenBtn = document.getElementById('fullscreenBtn');
        if (fullscreenBtn) {
            fullscreenBtn.addEventListener('click', toggleFullscreen);
            // ì „ì²´í™”ë©´ ìƒíƒœ ë³€ê²½ ê°ì§€
            document.addEventListener('fullscreenchange', updateFullscreenIcon);
            document.addEventListener('webkitfullscreenchange', updateFullscreenIcon);
            document.addEventListener('mozfullscreenchange', updateFullscreenIcon);
            document.addEventListener('MSFullscreenChange', updateFullscreenIcon);
        }
        
        // ë©”ë‰´ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
        document.addEventListener('click', (e) => {
            if (!pdfMenu.contains(e.target) && e.target !== pdfBtn) {
                pdfMenu.classList.remove('show');
            }
            if (themeMenu && !themeMenu.contains(e.target) && e.target !== themeBtn) {
                themeMenu.classList.remove('show');
            }
        });
        
        // í…Œë§ˆ ì „í™˜ í•¨ìˆ˜
        function switchTheme(theme) {
            if (!theme || (theme !== 'dark-blue' && theme !== 'white')) {
                return;
            }
            
            // í…Œë§ˆ ì ìš©
            document.documentElement.setAttribute('data-theme', theme);
            
            // REPORT_CONFIG ì—…ë°ì´íŠ¸
            if (REPORT_CONFIG && REPORT_CONFIG.settings) {
                REPORT_CONFIG.settings.theme = theme;
            }
            
            // í˜ì´ì§€ ì¬ë Œë”ë§
            renderApp();
            
            // í…Œë§ˆ ë©”ë‰´ì—ì„œ í™œì„± ìƒíƒœ ì—…ë°ì´íŠ¸
            const darkBlueItem = document.getElementById('themeDarkBlue');
            const whiteItem = document.getElementById('themeWhite');
            
            if (darkBlueItem && whiteItem) {
                if (theme === 'dark-blue') {
                    darkBlueItem.classList.add('active');
                    whiteItem.classList.remove('active');
                } else {
                    whiteItem.classList.add('active');
                    darkBlueItem.classList.remove('active');
                }
            }
            
            // í…Œë§ˆ ë©”ë‰´ ë‹«ê¸°
            if (themeMenu) {
                themeMenu.classList.remove('show');
            }
        }
        
        // ì „ì²´í™”ë©´ ì „í™˜ í•¨ìˆ˜
        function toggleFullscreen() {
            const mainContent = document.getElementById('mainContent');
            const element = mainContent || document.documentElement;
            
            if (!document.fullscreenElement && 
                !document.webkitFullscreenElement && 
                !document.mozFullScreenElement && 
                !document.msFullscreenElement) {
                // ì „ì²´í™”ë©´ ì§„ì…
                if (element.requestFullscreen) {
                    element.requestFullscreen();
                } else if (element.webkitRequestFullscreen) {
                    element.webkitRequestFullscreen();
                } else if (element.mozRequestFullScreen) {
                    element.mozRequestFullScreen();
                } else if (element.msRequestFullscreen) {
                    element.msRequestFullscreen();
                }
            } else {
                // ì „ì²´í™”ë©´ ì¢…ë£Œ
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.mozCancelFullScreen) {
                    document.mozCancelFullScreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                }
            }
        }
        
        // ì „ì²´í™”ë©´ ì•„ì´ì½˜ ì—…ë°ì´íŠ¸
        function updateFullscreenIcon() {
            const fullscreenBtn = document.getElementById('fullscreenBtn');
            if (!fullscreenBtn) return;
            
            const isFullscreen = !!(document.fullscreenElement || 
                                   document.webkitFullscreenElement || 
                                   document.mozFullScreenElement || 
                                   document.msFullscreenElement);
            
            if (isFullscreen) {
                fullscreenBtn.innerHTML = 'â›¶';
                fullscreenBtn.title = 'ì „ì²´í™”ë©´ ì¢…ë£Œ (ESC)';
            } else {
                fullscreenBtn.innerHTML = 'â›¶';
                fullscreenBtn.title = 'ì „ì²´í™”ë©´';
            }
        }
        
        // ESC í‚¤ë¡œ ì „ì²´í™”ë©´ ì¢…ë£Œ
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                const isFullscreen = !!(document.fullscreenElement || 
                                       document.webkitFullscreenElement || 
                                       document.mozFullScreenElement || 
                                       document.msFullscreenElement);
                if (isFullscreen) {
                    toggleFullscreen();
                }
            }
        });
        
        // PDF ìƒì„± í•¨ìˆ˜ (ì›Œí„°ë§ˆí¬ ì˜µì…˜ í¬í•¨)
        async function generatePDF(includeWatermark = false) {
            // ë©”ë‰´ ë‹«ê¸°
            pdfMenu.classList.remove('show');
            
            const { jsPDF } = window.jspdf;
            const loading = document.getElementById('pdfLoading');
            const progress = document.getElementById('pdfProgress');
            loading.style.display = 'flex';
            
            try {
                // í°íŠ¸ ë¡œë”© ì™„ë£Œ ëŒ€ê¸°
                progress.textContent = 'í°íŠ¸ ë¡œë”© ì¤‘...';
                await waitForFonts();
                
                // ìŠ¬ë¼ì´ë“œ ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
                const slides = document.querySelectorAll('.slide-page');
                if (!slides || slides.length === 0) {
                    throw new Error('ìŠ¬ë¼ì´ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
                }
                
                const doc = new jsPDF('l', 'mm', 'a4');
                const pdfWidth = 297;
                const pdfHeight = 210;
                
                const captureContainer = document.createElement('div');
                Object.assign(captureContainer.style, { 
                    position: 'fixed', 
                    top: '0', 
                    left: '0', 
                    width: '1123px', 
                    height: '794px', 
                    zIndex: '-9999', 
                    overflow: 'hidden', 
                    backgroundColor: '#0f172a' 
                });
                document.body.appendChild(captureContainer);

                for (let i = 0; i < slides.length; i++) {
                    progress.textContent = `${Math.round(((i + 1) / slides.length) * 100)}%`;
                    const clone = slides[i].cloneNode(true);
                    
                    // ìŠ¤íƒ€ì¼ ì´ˆê¸°í™”
                    clone.classList.remove('preview', 'preview-left', 'preview-right');
                    clone.style.transform = 'none';
                    clone.style.transition = 'none';
                    clone.style.opacity = '1';
                    clone.style.filter = 'none';
                    clone.style.margin = '0';
                    clone.style.boxShadow = 'none';
                    
                    // í˜„ì¬ ìŠ¬ë¼ì´ë“œë¥¼ í´ë¡œì €ë¡œ ì €ì¥ (onclone ì½œë°±ì—ì„œ ì‚¬ìš©)
                    const currentSlide = slides[i];
                    
                    // ìº”ë²„ìŠ¤ ë³µì œ (ì°¨íŠ¸ìš©)
                    const origCanvases = currentSlide.querySelectorAll('canvas');
                    const cloneCanvases = clone.querySelectorAll('canvas');
                    if (origCanvases.length > 0) {
                        origCanvases.forEach((orig, idx) => {
                            if (cloneCanvases[idx]) {
                                cloneCanvases[idx].width = orig.width;
                                cloneCanvases[idx].height = orig.height;
                                cloneCanvases[idx].getContext('2d').drawImage(orig, 0, 0);
                            }
                        });
                    }

                    captureContainer.appendChild(clone);
                    
                    // ì´ë¯¸ì§€ ë¡œë”© ì™„ë£Œ ëŒ€ê¸° ë° ë¹„ìœ¨ ìœ ì§€ ì„¤ì • (ëª¨ë“  img íƒœê·¸)
                    const images = clone.querySelectorAll('img');
                    const imagePromises = Array.from(images).map(img => {
                        if (img.complete && img.naturalWidth > 0) {
                            // ì´ë¯¸ ë¡œë“œëœ ì´ë¯¸ì§€ì˜ ë¹„ìœ¨ ìœ ì§€ ì„¤ì •
                            img.style.objectFit = 'contain';
                            img.style.objectPosition = 'center';
                            return Promise.resolve();
                        }
                        return new Promise((resolve, reject) => {
                            img.onload = () => {
                                // ì´ë¯¸ì§€ ë¡œë“œ ì™„ë£Œ í›„ ë¹„ìœ¨ ìœ ì§€ ì„¤ì •
                                img.style.objectFit = 'contain';
                                img.style.objectPosition = 'center';
                                resolve();
                            };
                            img.onerror = () => {
                                // ì—ëŸ¬ê°€ ë‚˜ë„ ë¹„ìœ¨ ì„¤ì •ì€ ì ìš©
                                img.style.objectFit = 'contain';
                                img.style.objectPosition = 'center';
                                resolve();
                            };
                            setTimeout(() => {
                                img.style.objectFit = 'contain';
                                img.style.objectPosition = 'center';
                                resolve();
                            }, 5000); // ìµœëŒ€ 5ì´ˆ ëŒ€ê¸°
                        });
                    });
                    await Promise.all(imagePromises);
                    
                    // DOM ë Œë”ë§ ì™„ë£Œ ëŒ€ê¸° (íŠ¹íˆ ë§ˆì§€ë§‰ í˜ì´ì§€)
                    await new Promise(resolve => {
                        // requestAnimationFrameì„ ë‘ ë²ˆ ì‚¬ìš©í•˜ì—¬ ë Œë”ë§ ì™„ë£Œ ë³´ì¥
                        requestAnimationFrame(() => {
                            requestAnimationFrame(() => {
                                // ì¶”ê°€ ì•ˆì „ ëŒ€ê¸° (ë§ˆì§€ë§‰ í˜ì´ì§€ëŠ” ë” ê¸¸ê²Œ)
                                setTimeout(resolve, i === slides.length - 1 ? 500 : 200);
                            });
                        });
                    });
                    
                    // ë§ˆì§€ë§‰ í˜ì´ì§€ì˜ ê²½ìš° ì¶”ê°€ ìŠ¤íƒ€ì¼ ë³´ì •
                    if (i === slides.length - 1) {
                        clone.style.height = '794px';
                        clone.style.minHeight = '794px';
                        clone.style.maxHeight = '794px';
                        clone.style.overflow = 'visible';
                    }
                    
                    // html2canvasë¡œ í˜ì´ì§€ë¥¼ ì´ë¯¸ì§€(Canvas)ë¡œ ìº¡ì²˜
                    let canvas;
                    let retryCount = 0;
                    const maxRetries = 3;
                    
                    while (retryCount < maxRetries) {
                        try {
                            canvas = await html2canvas(clone, { 
                                scale: 2, // ê³ í•´ìƒë„ ìº¡ì²˜ (2ë°° ìŠ¤ì¼€ì¼ë¡œ ë³€ê²½ - ì„±ëŠ¥ ê°œì„ )
                                useCORS: true, 
                                allowTaint: true, // ì™¸ë¶€ ì´ë¯¸ì§€ í—ˆìš©
                                imageTimeout: 30000,
                                logging: false,
                                backgroundColor: '#0f172a',
                                width: 1123,
                                height: 794,
                                windowWidth: 1123,
                                windowHeight: 794,
                                scrollX: 0,
                                scrollY: 0,
                                removeContainer: false, // ì»¨í…Œì´ë„ˆ ì œê±° ë°©ì§€
                                foreignObjectRendering: false, // foreignObject ë¹„í™œì„±í™”ë¡œ í˜¸í™˜ì„± ê°œì„ 
                                ignoreElements: (element) => {
                                    // í˜¸ë²„ ë©”ì‹œì§€ ìš”ì†Œë§Œ ì •í™•í•˜ê²Œ ì œì™¸
                                    if (element.tagName === 'SPAN' || element.tagName === 'DIV') {
                                        const text = element.textContent || '';
                                        // ì§ì ‘ì ì¸ í…ìŠ¤íŠ¸ë§Œ í™•ì¸ (ìì‹ ìš”ì†Œì˜ í…ìŠ¤íŠ¸ëŠ” ì œì™¸)
                                        if (element.children.length === 0 && (text.includes('í´ë¦­í•˜ì—¬ í™•ëŒ€') || text.includes('ë„¤ì´ë²„ ì§€ë„ì—ì„œ ë³´ê¸°'))) {
                                            return true;
                                        }
                                    }
                                    return false;
                                },
                                onclone: (clonedDoc, element) => {
                            function getElementPath(el, root) {
                                const path = [];
                                let current = el;
                                while (current && current !== root) {
                                    let index = 0;
                                    let sibling = current.previousElementSibling;
                                    while (sibling) {
                                        if (sibling.tagName === current.tagName) index++;
                                        sibling = sibling.previousElementSibling;
                                    }
                                    path.unshift({ tag: current.tagName, index: index, className: current.className });
                                    current = current.parentElement;
                                }
                                return path;
                            }
                            
                            function getElementByPath(root, path) {
                                let current = root;
                                for (const step of path) {
                                    const children = Array.from(current.children).filter(
                                        el => el.tagName === step.tag && el.className === step.className
                                    );
                                    if (children[step.index]) {
                                        current = children[step.index];
                                    } else {
                                        return null;
                                    }
                                }
                                return current;
                            }

                            // ëª¨ë“  í˜ì´ì§€ì˜ ì• ë‹ˆë©”ì´ì…˜/íˆ¬ëª…ë„ ê°•ì œ í•´ì œ
                            const animateElements = clonedDoc.querySelectorAll('.animate-fade-up, .opacity-0');
                            animateElements.forEach(el => {
                                el.style.opacity = '1';       // íˆ¬ëª…ë„ 100% ê°•ì œ
                                el.style.animation = 'none';  // ì• ë‹ˆë©”ì´ì…˜ ì¤‘ì§€
                                el.style.transition = 'none'; // íŠ¸ëœì§€ì…˜ ì¤‘ì§€
                            });

                            // PDF ì €ì¥ ì‹œ "í´ë¦­í•˜ì—¬ í™•ëŒ€" ë° "ë„¤ì´ë²„ ì§€ë„ì—ì„œ ë³´ê¸°" ë©”ì‹œì§€ ìˆ¨ê¹€ ì²˜ë¦¬
                            const zoomSpans = clonedDoc.querySelectorAll('span[class*="group-hover:opacity"]');
                            zoomSpans.forEach(el => {
                                const text = el.textContent || '';
                                if (text.includes('í´ë¦­í•˜ì—¬ í™•ëŒ€') || text.includes('ğŸ”') || text.includes('ë„¤ì´ë²„ ì§€ë„ì—ì„œ ë³´ê¸°') || text.includes('ğŸ—ºï¸')) {
                                    el.style.display = 'none';
                                }
                            });
                            
                            // í˜¸ë²„ ì˜¤ë²„ë ˆì´ div ìˆ¨ê¹€
                            const hoverOverlays = clonedDoc.querySelectorAll('div[class*="group-hover:opacity"]');
                            hoverOverlays.forEach(el => {
                                // ìì‹ span ì¤‘ "í´ë¦­í•˜ì—¬ í™•ëŒ€" ë˜ëŠ” "ë„¤ì´ë²„ ì§€ë„ì—ì„œ ë³´ê¸°" í…ìŠ¤íŠ¸ë¥¼ ê°€ì§„ ê²ƒë§Œ í™•ì¸
                                const zoomSpan = el.querySelector('span');
                                if (zoomSpan) {
                                    const text = zoomSpan.textContent || '';
                                    if (text.includes('í´ë¦­í•˜ì—¬ í™•ëŒ€') || text.includes('ğŸ”') || text.includes('ë„¤ì´ë²„ ì§€ë„ì—ì„œ ë³´ê¸°') || text.includes('ğŸ—ºï¸')) {
                                        el.style.display = 'none';
                                    }
                                }
                            });

                            // ì´ë¯¸ì§€ ì›ë³¸ ë¹„ìœ¨ ìœ ì§€ ì²˜ë¦¬
                            const images = clonedDoc.querySelectorAll('img');
                            images.forEach(img => {
                                // object-fitì„ containìœ¼ë¡œ ì„¤ì •í•˜ì—¬ ì›ë³¸ ë¹„ìœ¨ ìœ ì§€
                                img.style.objectFit = 'contain';
                                img.style.objectPosition = 'center';
                                // ì´ë¯¸ì§€ê°€ ì°Œê·¸ëŸ¬ì§€ì§€ ì•Šë„ë¡ max-widthì™€ max-height ì œí•œ
                                if (!img.style.maxWidth) {
                                    img.style.maxWidth = '100%';
                                }
                                if (!img.style.maxHeight) {
                                    img.style.maxHeight = '100%';
                                }
                            });

                            // í‘œì§€ í˜ì´ì§€ ë°°ê²½ ì²˜ë¦¬
                            const coverPage = clonedDoc.querySelector('#page_0');
                            if (coverPage && i === 0) {
                                // ê·¸ë¼ë°ì´ì…˜ ë°°ê²½ ìš”ì†Œ ì°¾ê¸°
                                const gradientBg = coverPage.querySelector('.bg-gradient-to-br');
                                if (gradientBg) {
                                    // Tailwind ê·¸ë¼ë°ì´ì…˜ í´ë˜ìŠ¤ ì œê±°
                                    gradientBg.classList.remove('bg-gradient-to-br', 'from-slate-900', 'via-[#0f172a]', 'to-[#1e3a8a]');
                                    
                                    // ë°°ê²½ ì´ë¯¸ì§€ ì´ˆê¸°í™”
                                    gradientBg.style.backgroundImage = 'none';
                                    
                                    // ê·¸ë¼ë°ì´ì…˜ ëŒ€ì‹  ë‹¨ìƒ‰ ë°°ê²½ ì ìš© (ì§„í•œ ë‚¨ìƒ‰)
                                    gradientBg.style.backgroundColor = '#0f172a';
                                }
                                
                                // ë„íŠ¸ íŒ¨í„´ ë°°ê²½ë„ í™•ì¸
                                const dotPattern = coverPage.querySelector('[style*="radial-gradient"]');
                                if (dotPattern) {
                                    // ë„íŠ¸ íŒ¨í„´ì˜ opacity ë³´ì¥
                                    const originalDot = currentSlide.querySelector('[style*="radial-gradient"]');
                                    if (originalDot) {
                                        const computedStyle = window.getComputedStyle(originalDot);
                                        if (computedStyle.opacity) {
                                            dotPattern.style.opacity = computedStyle.opacity || '0.2';
                                        }
                                    }
                                }
                            }
                            
                            // ê²°ë¡  í˜ì´ì§€ ë°°ê²½/ë†’ì´ ì²˜ë¦¬
                            const lastPageIndex = slides.length - 1;
                            if (i === lastPageIndex) {
                                const conclusionPage = clonedDoc.querySelector(`#page_${lastPageIndex}`);
                                if (conclusionPage) {
                                    // ë§ˆì§€ë§‰ í˜ì´ì§€ ë†’ì´ ê°•ì œ ì„¤ì •
                                    conclusionPage.style.height = '794px';
                                    conclusionPage.style.minHeight = '794px';
                                    conclusionPage.style.maxHeight = '794px';
                                    conclusionPage.style.overflow = 'visible';
                                    
                                    // ë°°ê²½ ì´ë¯¸ì§€ ìš”ì†Œ ì°¾ì•„ì„œ ì œê±° ë˜ëŠ” ìˆ¨ê¹€
                                    const conclusionBg = conclusionPage.querySelector('[style*="background-image"]');
                                    if (conclusionBg) {
                                        conclusionBg.style.display = 'none';
                                        conclusionBg.style.backgroundImage = 'none';
                                        conclusionBg.style.opacity = '0';
                                    }
                                    // data-img ì†ì„±ì´ ìˆëŠ” ìš”ì†Œë„ í™•ì¸
                                    const dataImgBg = conclusionPage.querySelector('[data-img]');
                                    if (dataImgBg) {
                                        dataImgBg.style.display = 'none';
                                        dataImgBg.style.backgroundImage = 'none';
                                        dataImgBg.style.opacity = '0';
                                    }
                                }
                            }
                            
                            // í°íŠ¸ ê°•ì œ ì ìš© (PDFì—ì„œ í°íŠ¸ ë Œë”ë§ ë³´ì¥)
                            const allTextElements = clonedDoc.querySelectorAll('*');
                            allTextElements.forEach(clonedEl => {
                                // ì›ë³¸ ìŠ¬ë¼ì´ë“œì—ì„œ ë™ì¼í•œ ìœ„ì¹˜ì˜ ìš”ì†Œ ì°¾ê¸°
                                const clonedPath = getElementPath(clonedEl, clonedDoc);
                                const originalEl = getElementByPath(currentSlide, clonedPath);
                                
                                if (originalEl) {
                                    try {
                                        const computedStyle = window.getComputedStyle(originalEl);
                                        clonedEl.style.fontFamily = computedStyle.fontFamily || "'Noto Sans KR', 'Montserrat', sans-serif";
                                        clonedEl.style.fontWeight = computedStyle.fontWeight || 'normal';
                                        clonedEl.style.fontSize = computedStyle.fontSize || 'inherit';
                                        clonedEl.style.fontStyle = computedStyle.fontStyle || 'normal';
                                        // í…ìŠ¤íŠ¸ ìƒ‰ìƒë„ ëª…ì‹œì ìœ¼ë¡œ ì„¤ì •
                                        if (computedStyle.color) {
                                            clonedEl.style.color = computedStyle.color;
                                        }
                                    } catch (e) {
                                        // í°íŠ¸ ì ìš© ì‹¤íŒ¨ ì‹œ ê¸°ë³¸ê°’ ì‚¬ìš©
                                        clonedEl.style.fontFamily = "'Noto Sans KR', 'Montserrat', sans-serif";
                                    }
                                } else {
                                    // ì›ë³¸ì„ ì°¾ì§€ ëª»í•œ ê²½ìš° ê¸°ë³¸ í°íŠ¸ ì ìš©
                                    if (clonedEl.tagName && ['H1', 'H2', 'H3', 'H4', 'P', 'SPAN', 'DIV', 'LI', 'UL', 'OL'].includes(clonedEl.tagName)) {
                                        clonedEl.style.fontFamily = "'Noto Sans KR', 'Montserrat', sans-serif";
                                    }
                                }
                            });
                        }
                    });
                    
                            // ìº”ë²„ìŠ¤ê°€ ì œëŒ€ë¡œ ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸
                            if (!canvas || canvas.width === 0 || canvas.height === 0) {
                                throw new Error('Canvas ìƒì„± ì‹¤íŒ¨');
                            }
                            
                            break; // ì„±ê³µí•˜ë©´ ë£¨í”„ íƒˆì¶œ
                        } catch (error) {
                            retryCount++;
                            const errorMsg = error?.message || error?.toString() || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜';
                            console.warn(`í˜ì´ì§€ ${i + 1} ìº¡ì²˜ ì‹¤íŒ¨ (ì¬ì‹œë„ ${retryCount}/${maxRetries}):`, error);
                            
                            if (retryCount >= maxRetries) {
                                throw new Error(`í˜ì´ì§€ ${i + 1} ìº¡ì²˜ ì‹¤íŒ¨: ${errorMsg}`);
                            }
                            
                            // ì¬ì‹œë„ ì „ ëŒ€ê¸°
                            await new Promise(resolve => setTimeout(resolve, 500 * retryCount));
                        }
                    }
                    
                    // Canvasë¥¼ ì´ë¯¸ì§€ ë°ì´í„°ë¡œ ë³€í™˜ (JPEG í˜•ì‹)
                    const imgData = canvas.toDataURL('image/jpeg', 0.95); // JPEG í’ˆì§ˆ 95%
                    
                    // ì´ë¯¸ì§€ ë°ì´í„° ê²€ì¦
                    if (!imgData || imgData === 'data:,') {
                        throw new Error(`í˜ì´ì§€ ${i + 1}ì˜ ì´ë¯¸ì§€ ë°ì´í„° ìƒì„± ì‹¤íŒ¨`);
                    }
                    
                    // PDFì— í˜ì´ì§€ ì¶”ê°€ ë° ì´ë¯¸ì§€ ì‚½ì…
                    if (i > 0) doc.addPage(); // ì²« í˜ì´ì§€ê°€ ì•„ë‹ˆë©´ ìƒˆ í˜ì´ì§€ ì¶”ê°€
                    doc.addImage(imgData, 'JPEG', 0, 0, pdfWidth, pdfHeight); // ì´ë¯¸ì§€ë¥¼ PDF í˜ì´ì§€ì— ì‚½ì…
                    
                    // ì›Œí„°ë§ˆí¬ ì¶”ê°€ (includeWatermarkê°€ trueì¼ ë•Œë§Œ)
                    if (includeWatermark) {
                        const watermarkText = "KPLAN GROUP The K Real Estate Agency"; // ì˜ë¬¸ ê¶Œì¥
                        
                        // 1. í°íŠ¸ ì„¤ì • (ê°œìˆ˜ê°€ ë§ì•„ì§€ë¯€ë¡œ í¬ê¸°ë¥¼ 20ìœ¼ë¡œ ì‚´ì§ ì¤„ì„)
                        doc.setFontSize(16); 
                        doc.setFont("helvetica", "bold");
                        doc.setTextColor(220, 220, 220); // ì—°í•œ íšŒìƒ‰

                        // 2. íˆ¬ëª…ë„ ì ìš© (0.15 = 15% ë¶ˆíˆ¬ëª…ë„)
                        try {
                            if (window.jspdf && window.jspdf.GState) {
                                doc.setGState(new window.jspdf.GState({ opacity: 0.03 }));
                            }
                        } catch (e) {}
                        
                        // 3. ê°„ê²© ì„¤ì • (ìˆ«ìê°€ ì‘ì„ìˆ˜ë¡ ë” ì´˜ì´˜í•´ì§‘ë‹ˆë‹¤)
                        const stepX = 40;  // ê°€ë¡œ ê°„ê²© (ê¸°ì¡´ 120 -> 60)
                        const stepY = 30;  // ì„¸ë¡œ ê°„ê²© (ê¸°ì¡´ 100 -> 50)
                        const angle = 45;

                        // 4. ë°˜ë³µ ì¶œë ¥
                        for (let x = -100; x < pdfWidth + 100; x += stepX) {
                            for (let y = -100; y < pdfHeight + 100; y += stepY) {
                                // ì§€ê·¸ì¬ê·¸ ë°°ì¹˜
                                const offsetX = (Math.floor(y / stepY) % 2) * (stepX / 2);
                                
                                doc.text(watermarkText, x + offsetX, y, {
                                    angle: angle,
                                    align: 'center',
                                    renderingMode: 'fill'
                                });
                            }
                        }

                        // 5. íˆ¬ëª…ë„ ì´ˆê¸°í™”
                        try {
                            if (window.jspdf && window.jspdf.GState) {
                                doc.setGState(new window.jspdf.GState({ opacity: 1.0 }));
                            }
                        } catch (e) {}
                    }
                    
                    // ë©”ì¸ í˜ì´ì§€ë¥¼ ì œì™¸í•œ ëª¨ë“  í˜ì´ì§€ì— í•˜ë‹¨ í…ìŠ¤íŠ¸ ì¶”ê°€
                    if (i > 0) {
                        doc.setFontSize(8);
                        doc.setTextColor(100, 116, 139); // slate-500 ìƒ‰ìƒ
                        doc.setFont("helvetica", "normal");
                        const copyrightText = REPORT_CONFIG.settings.copyright || 'COPYRIGHT Â© 2025 KOREA FACTORY. ALL RIGHTS RESERVED.';
                        
                        // ì¹´í”¼ë¼ì´íŠ¸ ê°€ìš´ë° ì •ë ¬
                        doc.text(copyrightText, pdfWidth / 2, pdfHeight - 5, { align: 'center' });
                        
                        // í˜ì´ì§€ ìˆ˜ëŠ” ì˜¤ë¥¸ìª½ì— ìœ ì§€
                        doc.text(`Page ${i + 1} / ${slides.length}`, pdfWidth - 20, pdfHeight - 5);
                    }
                    
                    // ìº¡ì²˜ìš© ë³µì œë³¸ ì œê±° (ë‹¤ìŒ í˜ì´ì§€ ì²˜ë¦¬ ì „ì— í™•ì‹¤íˆ ì •ë¦¬)
                    captureContainer.removeChild(clone);
                    
                    // ë©”ëª¨ë¦¬ ì •ë¦¬ë¥¼ ìœ„í•œ ì§§ì€ ëŒ€ê¸° (íŠ¹íˆ ë§ˆì§€ë§‰ í˜ì´ì§€ ì „)
                    if (i < slides.length - 1) {
                        await new Promise(resolve => setTimeout(resolve, 50));
                    }
                }
                document.body.removeChild(captureContainer);
                
                // íŒŒì¼ëª… ì„¤ì • (íƒ€ì´í‹€ ê¸°ë°˜, ì›Œí„°ë§ˆí¬ ì—¬ë¶€ì— ë”°ë¼)
                const baseTitle = REPORT_CONFIG.settings.pageTitle || 'Consulting_Report';
                // íŒŒì¼ëª…ì— ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ë¬¸ì ì œê±°
                const sanitizedTitle = baseTitle.replace(/[<>:"/\\|?*]/g, '').trim();
                const fileName = includeWatermark ? `${sanitizedTitle} (ì›Œí„°ë§ˆí¬).pdf` : `${sanitizedTitle}.pdf`;
                doc.save(fileName);
            } catch (e) { 
                console.error('PDF Error:', e);
                const errorMsg = e?.message || e?.toString() || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜';
                alert('PDF Error: ' + errorMsg); 
            } 
            finally { 
                loading.style.display = 'none'; 
            }
        }
    </script>
</body>
</html>
